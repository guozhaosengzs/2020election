library(tidyverse)
library(ggplot2)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
View(election_small)
`geoMap(1)` <- read.csv2("C:/Users/Matthew/Downloads/geoMap(1).csv", sep="", comment.char="#")
View(`geoMap(1)`)
`geoMap(1)` <- read.csv("C:/Users/Matthew/Downloads/geoMap(1).csv")
View(`geoMap(1)`)
View(`geoMap(1)`)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
TrumpSearch <- read.csv("C:/Users/Matthew/Downloads/geoMap(1).csv")
View(TrumpSearch)
names(TrumpSearch)
names(TrumpSearch)[1] <- "State"
names(TrumpSearch)[1] <- "state"
election_small$winner_binary <- ifelse(election_small$winner == "Trump", 1, 0)
election_small <- merge(election_small, TrumpSearch, by="state")
library(islr)
install.packages("ISLR")
library(ISLR)
cor(election_small$TrumpSearch, election_small$winner_binary)
View(election2016)
View(election_small)
View(TrumpSearch)
wikileakssearch <- read.csv("~/GitHub/2020election/matt/wikileakssearch.csv")
View(wikileakssearch)
ClintonSearch <- read.csv("~/GitHub/2020election/matt/ClintonSearch.csv")
View(ClintonSearch)
election_small <- merge(election_small, ClintonSearch, by="state")
election_small <- merge(election_small, wikileakssearch, by="state")
View(election_small)
plot(election_small$wikileaks, election_small$winner_binary)
plot(election_small$ClintonSearch, election_small$winner_binary)
plot(election_small$TrumpSearch, election_small$winner_binary)
BillClinton <- read.csv("~/GitHub/2020election/matt/BillClinton.csv")
View(BillClinton)
election_small <- merge(election_small, BillClinton, by="state")
plot(election_small$BillClinton, election_small$winner_binary)
FacebookSearch <- read.csv("~/GitHub/2020election/matt/FacebookSearch.csv")
View(FacebookSearch)
election_small <- merge(election_small, FacebookSearch, by="state")
plot(election_small$facebook, election_small$winner_binary)
BenghaziSearch <- read.csv("~/GitHub/2020election/matt/BenghaziSearch.csv")
View(BenghaziSearch)
election_small <- merge(election_small, BenghaziSearch, by="state")
plot(election_small$benghazi, election_small$winner_binary)
FoxNewsSearch <- read.csv("~/GitHub/2020election/matt/FoxNewsSearch.csv")
View(FoxNewsSearch)
election_small <- merge(election_small, FoxNewsSearch, by="state")
plot(election_small$FoxNews, election_small$winner_binary)
CNNSearch <- read.csv("~/GitHub/2020election/matt/CNNSearch.csv")
View(CNNSearch)
election_small <- merge(election_small, CNNSearch, by="state")
plot(election_small$CNN, election_small$winner_binary)
View(election_small)
election_small$margin_revised <- ifelse(election_small$winner == "Clinton", -1 * election_small$pct_margin, election_small$pct_margin)
plot(election_small$CNN, election_small$pct_margin)
plot(election_small$FoxNews, election_small$pct_margin)
plot(election_small$benghazi, election_small$pct_margin)
plot(election_small$benghazi, election_small$margin_revised)
plot(election_small$CNN, election_small$margin_revised)
plot(election_small$FoxNews, election_small$margin_revised)
plot(election_small$BillClinton, election_small$margin_revised)
plot(election_small$wikileaks, election_small$margin_revised)
plot(election_small$ClintonSearch, election_small$margin_revised)
plot(election_small$facebook, election_small$margin_revised)
View(ClintonSearch)
View(election_small)
View(FacebookSearch)
plot(election_small$BillClinton, election_small$winner_binary)
plot(election_small$BillClinton, election_small$margin_revised)
plot(election_small$FoxNews, election_small$margin_revised)
plot(election_small$CNN, election_small$margin_revised)
plot(election_small$wikileaks, election_small$margin_revised)
plot(election_small$benghazi, election_small$margin_revised)
View(election2016)
View(election_small)
View(election2016)
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches.csv")
View(state_searches)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
library(tidyverse)
library(ggplot2)
library(ISLR)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
election_small$winner_binary <- ifelse(election_small$winner == "Trump", 1, 0)
election_small$margin_revised <- ifelse(election_small$winner == "Clinton", -1 * election_small$pct_margin, election_small$pct_margin)
View(state_searches)
View(state_searches)
names(state_searches)[1]
names(state_searches)[1] <- 'state'
election_combined <- merge(election_small, state_searches, by='state')
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
election_small$winner_binary <- ifelse(election_small$winner == "Trump", 1, 0)
election_small$margin_revised <- ifelse(election_small$winner == "Clinton", -1 * election_small$pct_margin, election_small$pct_margin)
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches.csv")
View(state_searches)
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches.csv")
names(state_searches)[1] <- 'state'
election_combined <- merge(election_small, state_searches, by='state')
View(election_combined)
pairs(election_combined)
names(state_searches)
pairs(election_combined, margin_revised ~ Benghazi + immigration + racism + fake.news + Twitter + WikiLeaks + CNN)
pairs(data=election_combined, margin_revised ~ Benghazi + immigration + racism + fake.news + Twitter + WikiLeaks + CNN)
pairs(data=election_combined, margin_revised ~ )
pairs(data=election_combined, margin_revised ~ Trump + Clinton + CNN + wikiLeaks + Make.America.Great.Again + Benghazi + Fox.News +
Facebook + Instagram + Twitter + fake.news + black.lives.matter + antifa + healthcare + immigration + racism)
pairs(data=election_combined, margin_revised ~ Trump + Clinton + CNN + WikiLeaks + Make.America.Great.Again + Benghazi + Fox.News +
Facebook + Instagram + Twitter + fake.news + black.lives.matter + antifa + healthcare + immigration + racism)
election_predict <- lm(margin_revised ~ Trump + Clinton + CNN + WikiLeaks + Make.America.Great.Again + Benghazi + Fox.News +
Facebook + Instagram + Twitter + fake.news + black.lives.matter + antifa + healthcare + immigration + racism,
data=election_combined)
View(election_predict)
summary(election_predict)
election_predict <- lm(margin_revised ~ Trump + Clinton + CNN + WikiLeaks + Make.America.Great.Again + Benghazi + Fox.News +
Facebook + Instagram + Twitter,
data=election_combined)
summary(election_predict)
election_predict <- lm(margin_revised ~ Trump + CNN + WikiLeaks + Make.America.Great.Again + Benghazi + Fox.News +
Facebook + Instagram + Twitter,
data=election_combined)
summary(election_predict)
election_predict <- lm(margin_revised ~ Trump + CNN + Benghazi + Fox.News +
Facebook + Instagram + Twitter,
data=election_combined)
summary(election_predict)
election_predict <- lm(margin_revised ~ Trump + CNN + Benghazi + Fox.News +
Facebook + Instagram,
data=election_combined)
summary(election_predict)
pairs(data=election_combined, margin_revised ~ Trump + Clinton + CNN + WikiLeaks + Make.America.Great.Again + Benghazi + Fox.News +
Facebook + Instagram + Twitter + fake.news + black.lives.matter + antifa + healthcare + immigration + racism)
pairs(data=election_combined, margin_revised ~ Facebook + Instagram + Twitter + fake.news + black.lives.matter + antifa + healthcare + immigration + racism)
pairs(data=election_combined, margin_revised ~ Trump + Clinton + CNN + WikiLeaks + Make.America.Great.Again + Benghazi + Fox.News)
pairs(data=election_combined, margin_revised ~ Facebook + Instagram + Twitter + fake.news + black.lives.matter + antifa + healthcare + immigration + racism)
library(comprehenr)
install.packages("comprehenr")
library(comprehenr)
election_combined[1]
election_combined[2]
length(names(election_combined)
)
correlations <- to_list(cor(election_combined$margin_revised, election_combined[x]) for x in length(names(election_combined)))
install.packages("rpart")
library(rpart)
View(election2016)
library(tidyverse)
library(ggplot2)
library(ISLR)
library(rpart)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches.csv")
names(state_searches)[1] <- 'state'
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
election_small$winner_binary <- ifelse(election_small$winner == "Trump", 1, 0)
election_small$margin_revised <- ifelse(election_small$winner == "Clinton", -1 * election_small$pct_margin, election_small$pct_margin)
election_combined <- merge(election_small, state_searches, by='state')
pairs(data=election_combined, margin_revised ~ Trump + Clinton + CNN + WikiLeaks + Make.America.Great.Again + Benghazi + Fox.News)
pairs(data=election_combined, margin_revised ~ Facebook + Instagram + Twitter + fake.news + black.lives.matter + antifa + healthcare + immigration + racism)
election_predict <- lm(margin_revised ~ Trump + CNN + Benghazi + Fox.News +
Facebook + Instagram,
data=election_combined)
summary(election_predict)
names(election_combined)
names(election_combined)[5::]
names(election_combined)[5:]
names(election_combined)[5]
names(election_combined)[7]
names(election_combined)[7:20]
names(election_combined)[7:25]
names(election_combined)[7:30]
names(election_combined)[7:31]
names(election_combined)[7:30]
print(name)
for (name in names(election_combined)[7:30]) {
print(name)
}
for (name in names(election_combined)[7:30]) {
print(name)
summary(election_combined[name])
}
summary(election_combined[name])
rcorr(election_combined$pct_margin, election_combined[name])
for (name in names(election_combined)[7:30]) {
corr(election_combined$pct_margin, election_combined[name])
}
for (name in names(election_combined)[7:30]) {
cor(election_combined$pct_margin, election_combined[name])
}
summary(election_predict)
for (name in names(election_combined)[7:30]) {
print(cor(election_combined$pct_margin, election_combined[name]))
}
for (name in names(election_combined)[7:30]) {
print(cor(election_combined$margin_revised, election_combined[name]))
}
election_search <- election_combined %>% select(names(election_combined)[6:30])
View(election_search)
tree(data=election_search, formula=margin_revised ~ .)
library(tree)
library(rtree)
library(rpart)
model <- tree(data=election_search, formula=margin_revised ~ .)
model <- rpart(margin_revised ~ . , data=election_search)
summary(model)
library(rpart.plot)
install.packages("rpart.plot")
library(rpart.plot)
rpart.plot(model)
library(tidyverse)
library(ggplot2)
library(ISLR)
library(rpart)
library(rpart.plot)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches.csv")
names(state_searches)[1] <- 'state'
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
election_small$winner_binary <- ifelse(election_small$winner == "Trump", 1, 0)
election_small$margin_revised <- ifelse(election_small$winner == "Clinton", -1 * election_small$pct_margin, election_small$pct_margin)
election_combined <- merge(election_small, state_searches, by='state')
for (name in names(election_combined)[7:30]) {
print(cor(election_combined$margin_revised, election_combined[name]))
}
election_search <- election_combined %>% select(names(election_combined)[6:30])
model <- rpart(margin_revised ~ . , data=election_search)
rpart.plot(model)
for (name in names(election_combined)[7:15]) {
print(cor(election_combined$margin_revised, election_combined[name]))
}
election_search <- election_combined %>% select(names(election_combined)[6:30])
model <- rpart(margin_revised ~ . , data=election_search)
rpart.plot(model)
election_search <- election_combined %>% select(names(election_combined)[6:15])
model <- rpart(margin_revised ~ . , data=election_search)
rpart.plot(model)
library(tidyverse)
library(ggplot2)
library(ISLR)
library(rpart)
library(rpart.plot)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches.csv")
names(state_searches)[1] <- 'state'
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
election_small$winner_binary <- ifelse(election_small$winner == "Trump", 1, 0)
election_small$margin_revised <- ifelse(election_small$winner == "Clinton", -1 * election_small$pct_margin, election_small$pct_margin)
election_combined <- merge(election_small, state_searches, by='state')
for (name in names(election_combined)[7:30]) {
print(cor(election_combined$margin_revised, election_combined[name]))
}
election_search <- election_combined %>% select(names(election_combined)[6:30])
model <- rpart(margin_revised ~ . , data=election_search)
rpart.plot(model)
plot(election_search$Trump, election_search$margin_revised)
plot(election_search$Benghazi, election_search$margin_revised)
plot(election_search$WikiLeaks, election_search$margin_revised)
model <- rpart(margin_revised ~ . , data=election_search)
rpart.plot(model)
- election_search$Russia
- election_search[Russia]
View(election_search)
election_search[Russia]
election_search_revised <- election_search - election_search[Trump] - election_search[Fox.News] - election_search[Facebook]
names(election_search_revised)
names(election_search)
election_search_revised <- election_search[1] + election_search[3]
View(election_search_revised)
election_search_revised <- merge(election_search[1], election_search[3])
View(election_search_revised)
election_search_revised <- rbind(election_search[1], election_search[3])
library(tidyverse)
library(ggplot2)
library(ISLR)
library(rpart)
library(rpart.plot)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gitcnk/Data/master/election2016.csv')
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches.csv")
names(state_searches)[1] <- 'state'
# Let's create a smaller dataset.
election_small <- election2016 %>%
select(state, winner, vote_margin, pct_margin)
election_small$winner_binary <- ifelse(election_small$winner == "Trump", 1, 0)
election_small$margin_revised <- ifelse(election_small$winner == "Clinton", -1 * election_small$pct_margin, election_small$pct_margin)
election_combined <- merge(election_small, state_searches, by='state')
for (name in names(election_combined)[7:30]) {
print(cor(election_combined$margin_revised, election_combined[name]))
}
election_search <- election_combined %>% select(names(election_combined)[6:30])
model <- rpart(margin_revised ~ . , data=election_search)
rpart.plot(model)
election_search_revised <- rbind(election_search[1], election_search[3])
names(election_search)
View(model)
plot(model)
plots(model)
resid(model)
plot(resid(model))
election_search_revised <- election_search[,!(names(election_search) %in% c("Trump", "Fox.News", "Facebook", "Russia"))]
View(election_search_revised)
model_t <- rpart(margin_revised ~ . , data=election_search)
rpart.plot(model_t)
model_t <- rpart(margin_revised ~ . , data=election_search_revised)
rpart.plot(model_t)
model_f <- lm(margin_revised ~ China + Crimea + CNN + Fox.News + Russia + Trump + Facebook, data=election_search)
summary(model_f)
plot(model_f)
View(election2016)
View(election_search)
View(election2016)
library(tidyverse)
library(ggplot2)
library(ISLR)
library(rpart)
library(rpart.plot)
election2016 <- read.csv(file = 'https://raw.githubusercontent.com/gracejanes/Test1/master/presidential_poll_averages_2020.csv')
election2020 <- read.csv(file = 'https://raw.githubusercontent.com/gracejanes/Test1/master/presidential_poll_averages_2020.csv')
state_searches <- read.csv("~/GitHub/2020election/matt/state_searches2020.csv")
View(election2020)
names(state_searches)[1] <- 'state'
election2020 <- election2020 %>% filter(modeldate == '9/29/2020')
trump2020 <- election2020 %>% filter(candidate_name != 'Joseph R. Biden Jr.')
biden2020 <- election2020 %>% filter(candidate_name == 'Joseph R. Biden Jr.')
trump2020 <- election2020 %>% filter(candidate_name == 'Donald J. Trump')
trump2020 <- election2020 %>% filter(candidate_name == 'Donald Trump')
election2020compare <- merge(biden2020, trump2020, by='state')
View(election2020compare)
names(election2020compare)
names(electoin2020compare)[6] <- biden_pct
names(electoin2020compare)[6] = biden_pct
names(electoin2020compare)[6] <- 'biden_pct'
names(election2020compare)[6] <- 'biden_pct'
names(election2020compare)[11] <- 'trump_pct'
View(state_searches)
election2020compare$poll_margin <- election2020compare$trump_pct - election2020compare$biden_pct
election2020combined <- merge(election2020compare, state_searches, by='state')
View(election2020combined)
names(election2020combined)
election2020combined <- election2020combined %>% select(names(election2020combined)[12::])
election2020combined <- election2020combined %>% select(names(election2020combined)[12:])
election2020combined <- election2020combined %>% select(names(election2020combined)[12:39])
model <- rpart(poll_margin ~ . , data=election2020combined)
rpart.plot(model)
election2020_revised <- election2020combined[,!(names(election2020combined) %in% c("Trump", "Fox.News", "social.distancing"))]
model_t <- rpart(margin_revised ~ . , data=election_search_revised)
rpart.plot(model_t)
election2020_revised <- election2020_revised[,!(names(election2020_revised) %in% c("China", "Crimea", "CNN"))]
model_t <- rpart(margin_revised ~ . , data=election_search_revised)
rpart.plot(model_t)
View(election2020_revised)
election2020_revised <- election2020combined[,!(names(election2020combined) %in% c("Trump", "Fox.News", "social.distancing"))]
model_t <- rpart(margin_revised ~ . , data=election2020_revised)
rpart.plot(model_t)
model_t <- rpart(poll_margin ~ . , data=election2020_revised)
rpart.plot(model_t)
election2020_revised <- election2020_revised[,!(names(election2020_revised) %in% c("NASDAQ", "Dow.Jones", "immigration"))]
model_t <- rpart(poll_margin ~ . , data=election2020_revised)
rpart.plot(model_t)
model_f <- lm(poll_margin ~ Trump + Fox.News + social.distancing + NASDAQ + Dow.Jones + immigration +
racism + Instagram + Russia, data=election2020_revised)
summary(model_f)
model_f <- lm(poll_margin ~ Trump + Fox.News + social.distancing + NASDAQ + Dow.Jones + immigration +
racism + Instagram + Russia, data=election2020combined)
summary(model_f)
plot(model_f)
View(election2020combined)
View(election2020_revised)
View(election2020combined)
View(election2020compare)
election2020combined <- merge(election2020compare, state_searches, by='state')
View(election2020combined)
View(biden2020)
View(election2020)
View(election_combined)
election2020compare <- merge(biden2020, trump2020, by='state')
View(election2020compare)
